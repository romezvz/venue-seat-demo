import{a as T,b as w}from"./chunk-TZLXWBTR.js";import{b as O,e as k}from"./chunk-ZCSKDXI7.js";import{a as N}from"./chunk-3RC7ENVT.js";import{$ as S,Ea as _,Ia as d,N as g,Pa as p,Qa as s,Ra as o,Sa as x,T as a,Va as C,Wa as u,Xa as m,Za as r,_ as b,_a as c,cb as h,va as l,vb as I,wb as y,xb as E,yb as F}from"./chunk-WUAIBPFC.js";var v=class n{_httpClient=a(O);_apiUrl=`${T.apiUrl}/seats`;getSeatsByEvent(t){return this._httpClient.get(`${this._apiUrl}?eventId=${t}`)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=g({token:n,factory:n.\u0275fac,providedIn:"root"})};var M=(n,t,e)=>({"bg-green-200":n,"bg-red-300 text-white":t,"ring-2 ring-black":e});function B(n,t){if(n&1){let e=C();s(0,"button",8),u("click",function(){let f=b(e).$implicit,j=m();return S(j.toggle(f))}),r(1),x(2,"br"),r(3),o()}if(n&2){let e=t.$implicit,i=m();p("ngClass",h(4,M,e.available,!e.available,i.selectedIds.includes(e.id)))("disabled",!e.available),l(),c(" ",e.id,""),l(2),c(" ",e.price," \u20AC ")}}function D(n,t){if(n&1&&(s(0,"div")(1,"h3",11),r(2),o(),s(3,"p")(4,"strong"),r(5,"Fecha:"),o(),r(6),o(),s(7,"p")(8,"strong"),r(9,"Asientos:"),o(),r(10),o(),s(11,"p")(12,"strong"),r(13,"Total:"),o(),r(14),o()()),n&2){let e=m().$implicit,i=m();l(2),c("Evento: ",i.selection.selections[e].event.name,""),l(4),c(" ",i.selection.selections[e].event.date,""),l(4),c(" ",i.getSelectedSeatIds(e).join(", ")," "),l(4),c(" ",i.selection.getTotal(e)," \u20AC ")}}function U(n,t){if(n&1&&(s(0,"div",9),d(1,D,15,4,"div",10),o()),n&2){let e=t.$implicit,i=m();l(),p("ngIf",i.selection.selections[e]==null||i.selection.selections[e].seats==null?null:i.selection.selections[e].seats.length)}}var $=class n{_seatService=a(v);_eventService=a(w);_route=a(k);selection=a(N);event;seats=[];selectedIds=[];selectionKeys=()=>Object.keys(this.selection.selections).map(Number);ngOnInit(){let t=Number(this._route.snapshot.paramMap.get("eventId"));this._seatService.getSeatsByEvent(t).subscribe(e=>this.seats=e),this._eventService.getEventById(t).subscribe(e=>{this.event=e})}toggle(t){this.selection.toggleSeat(this.event,t)}confirm(){alert("Compra simulada con \xE9xito \u2705"),this.selection.clearAll()}getSelectedSeatIds(t){return this.selection.selections[t]?.seats.map(e=>e.id)??[]}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=_({type:n,selectors:[["rz-seat-selector"]],decls:11,vars:2,consts:[[1,"p-4"],[1,"text-xl","font-bold","mb-4"],[1,"grid","grid-cols-4","gap-3","mb-6"],["class","p-2 border rounded transition",3,"ngClass","disabled","click",4,"ngFor","ngForOf"],[1,"p-3","border-t","pt-4"],[1,"text-lg","font-semibold","mb-2"],["class","mb-4",4,"ngFor","ngForOf"],[1,"mt-4","bg-blue-600","text-white","px-4","py-2","rounded","hover:bg-blue-700",3,"click"],[1,"p-2","border","rounded","transition",3,"click","ngClass","disabled"],[1,"mb-4"],[4,"ngIf"],[1,"font-bold"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"h2",1),r(2,"Selecciona tus asientos"),o(),s(3,"div",2),d(4,B,4,8,"button",3),o(),s(5,"div",4)(6,"h3",5),r(7,"Resumen"),o(),d(8,U,2,1,"div",6),s(9,"button",7),u("click",function(){return i.confirm()}),r(10," Confirmar compra "),o()()()),e&2&&(l(4),p("ngForOf",i.seats),l(4),p("ngForOf",i.selectionKeys()))},dependencies:[F,I,y,E],encapsulation:2})};export{$ as SeatSelectorComponent};
